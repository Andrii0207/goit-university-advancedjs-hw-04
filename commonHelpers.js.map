{"version":3,"file":"commonHelpers.js","sources":["../src/js/api.js","../src/js/markup.js","../src/js/main.js"],"sourcesContent":["import axios from \"axios\";\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '29711315-8270253fad608a552f88c48ec';\n\nfunction searchPhoto(searchQuery, page = 1) {\n    // return fetch(`${BASE_URL}?key=${API_KEY}&q=${searchQuery}&image_type=horizontal&safesearch=true`)\n    return axios({\n        baseURL: BASE_URL,\n        params: {\n            key: API_KEY,\n            q: searchQuery,\n            image_type: \"photo\",\n            orientation: \"horizontal\",\n            safesearch: true,\n            page,\n            per_page: 40,\n        }\n    });\n}\n\nexport default searchPhoto;\n","\n\nfunction createGallery(resp) {\n\n    return resp.map(({ largeImageURL, tags, likes, views, comments, downloads }) => `<div class=\"photo-card\">\n    <img class=\"photo\" src=\"${largeImageURL}\" alt=\"${tags}\" loading=\"lazy\" />\n    <div class=\"info\">\n        <p class=\"info-item\">\n            <b>Likes:</b> ${likes}\n        </p>\n        <p class=\"info-item\">\n            <b>Views:</b> ${views}\n        </p>\n        <p class=\"info-item\">\n            <b>Comments:</b> ${comments}\n        </p>\n        <p class=\"info-item\">\n            <b>Downloads:</b> ${downloads}\n        </p>\n    </div>\n</div>`).join(\"\")\n}\n\nexport default createGallery;\n\n// webformatURL - посилання на маленьке зображення для списку карток.\n// largeImageURL - посилання на велике зображення.\n// tags - рядок з описом зображення.Підійде для атрибуту alt.\n// likes - кількість лайків.\n// views - кількість переглядів.\n// comments - кількість коментарів.\n\n// downloads - кількість завантажень.","import searchPhoto from '/js/api';\nimport createGallery from './markup';\n\n\nconst refs = {\n    form: document.querySelector('.search-form'),\n    input: document.querySelector('.input'),\n    btn: document.querySelector('.submit-btn'),\n    gallery: document.querySelector('.gallery'),\n    loadMoreBtn: document.querySelector('.load-more'),\n    guard: document.querySelector('.js-guard')\n}\n\nrefs.loadMoreBtn.classList.add('visually-hidden')\nlet page = 1;\nlet searchQuery;\n\nconst options = {\n    root: null,\n    rootMargin: \"300px\",\n    threshold: 1.0,\n};\n\nlet observer = new IntersectionObserver(handlerLoadMore, options);\nobserver.observe(refs.guard)\n\nrefs.form.addEventListener('submit', onSearchSubmit)\n// refs.loadMoreBtn.addEventListener('click', handlerLoadMore)\n\nfunction handlerLoadMore(entries) {\n    entries.forEach(async entry => {\n        console.log(entry)\n        if (entry.isIntersecting) {\n            page += 1;\n            const resp = await searchPhoto(searchQuery, page);\n            const data = resp.data;\n            refs.gallery.insertAdjacentHTML('beforeend', createGallery(data.hits))\n            if (page >= 13) {\n                console.log(\"THE END\")\n                observer.disconnect()\n            }\n        }\n    });\n}\n\n// async function handlerLoadMore() {\n//     page += 1;\n//     const resp = await searchPhoto(searchQuery, page);\nconst data = resp.data;\nlet total_pages = data.hits.total / data.hits.totalHits\n//     console.log(\"resp load_more >>>\", resp)\n//     console.log(\"resp.data (load_more) >>>\", resp.data)\n//     refs.gallery.insertAdjacentHTML('beforeend', createGallery(data.hits));\n//     if (total_pages >= 500 || page >= 13) {\n//         console.log(\"click LOAD_MORE\")\n//         return refs.loadMoreBtn.classList.add('visually-hidden')\n//     }\n// }\n\nasync function onSearchSubmit(evt) {\n    evt.preventDefault();\n    page = 11;\n    searchQuery = evt.target.searchQuery.value;\n    const resp = await searchPhoto(searchQuery, page);\n    const data = resp.data;\n    console.log(\"resp (submit) >>>\", resp)\n    console.log(\"resp.data (submit) >>>\", data)\n    console.log(\"data.total (submit) >>>\", data.total)\n\n    if (data.hits.lenght === 0) {\n        return alert(\"Incorrect query name, try again\")\n    }\n    // if (data.total > 40) {\n    //     refs.loadMoreBtn.classList.remove('visually-hidden')\n    // }\n    refs.gallery.innerHTML = createGallery(data.hits);\n    refs.form.reset();\n    return;\n}\n\n"],"names":["BASE_URL","API_KEY","searchPhoto","searchQuery","page","axios","createGallery","resp","largeImageURL","tags","likes","views","comments","downloads","refs","options","observer","handlerLoadMore","onSearchSubmit","entries","entry","data","evt"],"mappings":"svBAEA,MAAMA,EAAW,2BACXC,EAAU,qCAEhB,SAASC,EAAYC,EAAaC,EAAO,EAAG,CAExC,OAAOC,EAAM,CACT,QAASL,EACT,OAAQ,CACJ,IAAKC,EACL,EAAGE,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAAC,EACA,SAAU,EACb,CACT,CAAK,CACL,CCjBA,SAASE,EAAcC,EAAM,CAEzB,OAAOA,EAAK,IAAI,CAAC,CAAE,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAS,IAAO;AAAA,8BACtDL,WAAuBC;AAAA;AAAA;AAAA,4BAGzBC;AAAA;AAAA;AAAA,4BAGAC;AAAA;AAAA;AAAA,+BAGGC;AAAA;AAAA;AAAA,gCAGCC;AAAA;AAAA;AAAA,OAGzB,EAAE,KAAK,EAAE,CAChB,CCjBA,MAAMC,EAAO,CACT,KAAM,SAAS,cAAc,cAAc,EAC3C,MAAO,SAAS,cAAc,QAAQ,EACtC,IAAK,SAAS,cAAc,aAAa,EACzC,QAAS,SAAS,cAAc,UAAU,EAC1C,YAAa,SAAS,cAAc,YAAY,EAChD,MAAO,SAAS,cAAc,WAAW,CAC7C,EAEAA,EAAK,YAAY,UAAU,IAAI,iBAAiB,EAChD,IAAIV,EAAO,EACPD,EAEJ,MAAMY,EAAU,CACZ,KAAM,KACN,WAAY,QACZ,UAAW,CACf,EAEA,IAAIC,EAAW,IAAI,qBAAqBC,EAAiBF,CAAO,EAChEC,EAAS,QAAQF,EAAK,KAAK,EAE3BA,EAAK,KAAK,iBAAiB,SAAUI,CAAc,EAGnD,SAASD,EAAgBE,EAAS,CAC9BA,EAAQ,QAAQ,MAAMC,GAAS,CAE3B,GADA,QAAQ,IAAIA,CAAK,EACbA,EAAM,eAAgB,CACtBhB,GAAQ,EAER,MAAMiB,GADO,MAAMnB,EAAYC,EAAaC,CAAI,GAC9B,KAClBU,EAAK,QAAQ,mBAAmB,YAAaR,EAAce,EAAK,IAAI,CAAC,EACjEjB,GAAQ,KACR,QAAQ,IAAI,SAAS,EACrBY,EAAS,WAAY,EAE5B,CACT,CAAK,CACL,CAKA,MAAMK,EAAO,KAAK,KACAA,EAAK,KAAK,MAAQA,EAAK,KAAK,UAU9C,eAAeH,EAAeI,EAAK,CAC/BA,EAAI,eAAc,EAClBlB,EAAO,GACPD,EAAcmB,EAAI,OAAO,YAAY,MACrC,MAAMf,EAAO,MAAML,EAAYC,EAAaC,CAAI,EAC1CiB,EAAOd,EAAK,KAKlB,GAJA,QAAQ,IAAI,oBAAqBA,CAAI,EACrC,QAAQ,IAAI,yBAA0Bc,CAAI,EAC1C,QAAQ,IAAI,0BAA2BA,EAAK,KAAK,EAE7CA,EAAK,KAAK,SAAW,EACrB,OAAO,MAAM,iCAAiC,EAKlDP,EAAK,QAAQ,UAAYR,EAAce,EAAK,IAAI,EAChDP,EAAK,KAAK,OAEd"}