{"version":3,"file":"commonHelpers.js","sources":["../src/js/service.js","../src/js/api.js","../src/js/markup.js","../src/js/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nfunction infoMessage(message) {\n    iziToast.info({\n        title: 'INFO',\n        message,\n        timeout: 3000,\n        position: \"topLeft\",\n        color: \"yellow\",\n    });\n}\n\nfunction successMessage(totalHits) {\n    iziToast.success({\n        title: 'SUCCESS',\n        message: `Hooray! We found ${totalHits} images.`,\n        timeout: 3000,\n        position: \"topLeft\",\n        color: \"green\",\n    });\n}\n\nfunction errorMessage(error) {\n    iziToast.error({\n        title: 'Error',\n        message: `${error}`,\n        timeout: 3000,\n        position: \"topLeft\",\n    });\n}\n\nexport { infoMessage, successMessage, errorMessage };","import axios from \"axios\";\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '29711315-8270253fad608a552f88c48ec';\n\nfunction searchPhoto(searchQuery, page = 1) {\n    return axios({\n        baseURL: BASE_URL,\n        params: {\n            key: API_KEY,\n            q: searchQuery,\n            image_type: \"photo\",\n            orientation: \"horizontal\",\n            safesearch: true,\n            page,\n            per_page: 40,\n        }\n    });\n}\n\nexport default searchPhoto;\n","\nfunction createGallery(resp) {\n    return resp.map(({ largeImageURL, webformatURL, tags, likes, views, comments, downloads }) => `\n    <li class=\"photo-card\">\n        <a class=\"photo-link\" href=\"${largeImageURL}\">\n            <img class=\"photo\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n        </a>\n    <div class=\"info\">\n        <p class=\"info-item\">\n            <b>Likes:</b> ${likes}\n        </p>\n        <p class=\"info-item\">\n            <b>Views:</b> ${views}\n        </p>\n        <p class=\"info-item\">\n            <b>Comments:</b> ${comments}\n        </p>\n        <p class=\"info-item\">\n            <b>Downloads:</b> ${downloads}\n        </p>\n    </div>\n</li>\n    `).join(\"\")\n}\n\nexport default createGallery;\n","import debounce from 'lodash.debounce';\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport { infoMessage, successMessage, errorMessage } from \"./service\";\nimport searchPhoto from '/js/api';\nimport createGallery from './markup';\n\nconst refs = {\n    form: document.querySelector('.search-form'),\n    input: document.querySelector('.input'),\n    btn: document.querySelector('.submit-btn'),\n    gallery: document.querySelector('.gallery'),\n    guard: document.querySelector('.js-guard'),\n    buttonUp: document.querySelector('.button-up')\n}\n\nlet page = 1;\nlet searchQuery;\n\nconst gallery = new SimpleLightbox(\".gallery a\", {\n    showCounter: false,\n    captionDelay: 250,\n    captionPosition: \"bottom\",\n    close: false,\n    overlayOpacity: 1,\n    captionsData: `alt`\n})\n\nconst options = {\n    root: null,\n    rootMargin: \"200px\",\n    threshold: 1.0,\n};\n\nlet observer = new IntersectionObserver(handlerLoadMore, options);\n\nrefs.form.addEventListener('submit', onSearchSubmit)\nwindow.addEventListener(\"scroll\", debounce(onViewportScroll, 500))\n\nasync function onSearchSubmit(evt) {\n    evt.preventDefault();\n    page = 1;\n    searchQuery = evt.target.searchQuery.value.trim().toLowerCase();\n\n    if (searchQuery === \"\") {\n        return infoMessage(\"Sorry, there are no images matching your search query. Please try again.\");\n    }\n    refs.gallery.innerHTML = '';\n\n    const resp = await searchPhoto(searchQuery, page);\n\n    if (resp.data.hits.length === 0) {\n        refs.form.reset();\n        return infoMessage(\"Sorry, there are no images matching your search query. Please try again.\");\n    }\n    successMessage(resp.data.total);\n\n    const total_pages = Math.ceil(resp.data.totalHits / resp.config.params.per_page)\n\n    refs.gallery.innerHTML = createGallery(resp.data.hits);\n\n    gallery.refresh();\n    refs.form.reset();\n\n    if (total_pages === 1 || !resp.data.hits) {\n        return setTimeout(() => {\n            infoMessage(\"We're sorry, but you've reached the end of search results.\")\n        }, 5000);\n    }\n    observer.observe(refs.guard);\n}\n\nfunction handlerLoadMore(entries) {\n    entries.forEach(async entry => {\n        if (entry.isIntersecting) {\n            page += 1;\n            const resp = await searchPhoto(searchQuery, page);\n            const total_pages = Math.ceil(resp.data.totalHits / resp.config.params.per_page)\n\n            refs.gallery.insertAdjacentHTML('beforeend', createGallery(resp.data.hits));\n            gallery.refresh();\n\n            if (page >= 13 || page >= total_pages) {\n                observer.disconnect();\n                return setTimeout(() => {\n                    infoMessage(\"We're sorry, but you've reached the end of search results.\")\n                }, 5000);\n            }\n        }\n    });\n}\n\nfunction onViewportScroll() {\n    if (window.scrollY >= 1000) {\n        refs.buttonUp.classList.toggle('visually-hidden', false);\n    } else {\n        refs.buttonUp.classList.toggle('visually-hidden', true);\n    }\n}\n"],"names":["infoMessage","message","iziToast","successMessage","totalHits","BASE_URL","API_KEY","searchPhoto","searchQuery","page","axios","createGallery","resp","largeImageURL","webformatURL","tags","likes","views","comments","downloads","refs","gallery","SimpleLightbox","options","observer","handlerLoadMore","onSearchSubmit","debounce","onViewportScroll","evt","total_pages","entries","entry"],"mappings":"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"}