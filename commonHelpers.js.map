{"version":3,"file":"commonHelpers.js","sources":["../src/js/service.js","../src/js/api.js","../src/js/markup.js","../src/js/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nfunction infoMessage(message) {\n    iziToast.info({\n        title: 'INFO',\n        message,\n        timeout: 3000,\n        position: \"topLeft\",\n        color: \"yellow\",\n    });\n}\n\nfunction successMessage(totalHits) {\n    iziToast.success({\n        title: 'SUCCESS',\n        message: `Hooray! We found ${totalHits} images.`,\n        timeout: 3000,\n        position: \"topLeft\",\n        color: \"green\",\n    });\n}\n\nexport { infoMessage, successMessage };","import axios from \"axios\";\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '29711315-8270253fad608a552f88c48ec';\n\nfunction searchPhoto(searchQuery, page = 1) {\n    // return fetch(`${BASE_URL}?key=${API_KEY}&q=${searchQuery}&image_type=horizontal&safesearch=true`)\n    return axios({\n        baseURL: BASE_URL,\n        params: {\n            key: API_KEY,\n            q: searchQuery,\n            image_type: \"photo\",\n            orientation: \"horizontal\",\n            safesearch: true,\n            page,\n            per_page: 40,\n        }\n    });\n}\n\nexport default searchPhoto;\n","\nfunction createGallery(resp) {\n\n    return resp.map(({ largeImageURL, tags, likes, views, comments, downloads }) => `<div class=\"photo-card\">\n    <img class=\"photo\" src=\"${largeImageURL}\" alt=\"${tags}\" loading=\"lazy\" />\n    <div class=\"info\">\n        <p class=\"info-item\">\n            <b>Likes:</b> ${likes}\n        </p>\n        <p class=\"info-item\">\n            <b>Views:</b> ${views}\n        </p>\n        <p class=\"info-item\">\n            <b>Comments:</b> ${comments}\n        </p>\n        <p class=\"info-item\">\n            <b>Downloads:</b> ${downloads}\n        </p>\n    </div>\n</div>`).join(\"\")\n}\n\nexport default createGallery;\n\n// webformatURL - посилання на маленьке зображення для списку карток.\n// largeImageURL - посилання на велике зображення.\n// tags - рядок з описом зображення.Підійде для атрибуту alt.\n// likes - кількість лайків.\n// views - кількість переглядів.\n// comments - кількість коментарів.\n\n// downloads - кількість завантажень.","import debounce from 'lodash.debounce';\nimport { infoMessage, successMessage } from \"./service\";\nimport searchPhoto from '/js/api';\nimport createGallery from './markup';\n\nconst refs = {\n    form: document.querySelector('.search-form'),\n    input: document.querySelector('.input'),\n    btn: document.querySelector('.submit-btn'),\n    gallery: document.querySelector('.gallery'),\n    guard: document.querySelector('.js-guard'),\n    buttonUp: document.querySelector('.button-up')\n}\n\nlet page = 1;\nlet searchQuery;\n\nconst options = {\n    root: null,\n    rootMargin: \"100px\",\n    threshold: 1.0,\n};\n\nlet observer = new IntersectionObserver(handlerLoadMore, options);\n\nrefs.form.addEventListener('submit', onSearchSubmit)\nwindow.addEventListener(\"scroll\", debounce(onViewportScroll, 500))\n// refs.loadMoreBtn.addEventListener('click', handlerLoadMore)\n\n// async function handlerLoadMore() {\n//     page += 1;\n//     const resp = await searchPhoto(searchQuery, page);\n// const data = resp.data;\n// let total_pages = data.hits.total / data.hits.totalHits\n//     console.log(\"resp load_more >>>\", resp)\n//     console.log(\"resp.data (load_more) >>>\", resp.data)\n//     refs.gallery.insertAdjacentHTML('beforeend', createGallery(data.hits));\n//     if (total_pages >= 500 || page >= 13) {\n//         console.log(\"click LOAD_MORE\")\n//         return refs.loadMoreBtn.classList.add('visually-hidden')\n//     }\n// }\n\nasync function onSearchSubmit(evt) {\n    evt.preventDefault();\n    page = 11;\n    searchQuery = evt.target.searchQuery.value;\n\n    if (searchQuery === \"\") {\n        return infoMessage(\"Sorry, there are no images matching your search query. Please try again.\");\n    }\n    observer.observe(refs.guard)\n\n    const resp = await searchPhoto(searchQuery, page);\n    const data = resp.data;\n    console.log(\"resp (submit) >>>\", resp)\n    console.log(\"resp.data (submit) >>>\", data)\n    console.log(\"data.total (submit) >>>\", data.total)\n    console.log(\"data.hits.length (submit) >>>\", data.hits.length)\n\n    if (data.hits.length === 0) {\n        infoMessage(\"Sorry, there are no images matching your search query. Please try again.\");\n        return refs.form.reset();\n    }\n    successMessage(data.total)\n\n    refs.gallery.innerHTML = createGallery(data.hits);\n    refs.form.reset();\n    return;\n}\n\nfunction handlerLoadMore(entries) {\n    entries.forEach(async entry => {\n        console.log(entry)\n        if (entry.isIntersecting) {\n            page += 1;\n            const resp = await searchPhoto(searchQuery, page);\n\n            refs.gallery.insertAdjacentHTML('beforeend', createGallery(resp.data.hits))\n\n            if (page >= 13) {\n                observer.disconnect();\n                return setTimeout(() => {\n                    infoMessage(\"We're sorry, but you've reached the end of search results.\")\n                }, 9000);\n            }\n        }\n    });\n}\n\nfunction onViewportScroll() {\n    if (window.scrollY >= 1000) {\n        refs.buttonUp.classList.toggle('visually-hidden', false);\n    } else {\n        refs.buttonUp.classList.toggle('visually-hidden', true);\n    }\n}\n"],"names":["infoMessage","message","iziToast","successMessage","totalHits","BASE_URL","API_KEY","searchPhoto","searchQuery","page","axios","createGallery","resp","largeImageURL","tags","likes","views","comments","downloads","refs","options","observer","handlerLoadMore","onSearchSubmit","debounce","onViewportScroll","evt","data","entries","entry"],"mappings":"owBAGA,SAASA,EAAYC,EAAS,CAC1BC,EAAS,KAAK,CACV,MAAO,OACP,QAAAD,EACA,QAAS,IACT,SAAU,UACV,MAAO,QACf,CAAK,CACL,CAEA,SAASE,EAAeC,EAAW,CAC/BF,EAAS,QAAQ,CACb,MAAO,UACP,QAAS,oBAAoBE,YAC7B,QAAS,IACT,SAAU,UACV,MAAO,OACf,CAAK,CACL,CCnBA,MAAMC,EAAW,2BACXC,EAAU,qCAEhB,SAASC,EAAYC,EAAaC,EAAO,EAAG,CAExC,OAAOC,EAAM,CACT,QAASL,EACT,OAAQ,CACJ,IAAKC,EACL,EAAGE,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAAC,EACA,SAAU,EACb,CACT,CAAK,CACL,CClBA,SAASE,EAAcC,EAAM,CAEzB,OAAOA,EAAK,IAAI,CAAC,CAAE,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAS,IAAO;AAAA,8BACtDL,WAAuBC;AAAA;AAAA;AAAA,4BAGzBC;AAAA;AAAA;AAAA,4BAGAC;AAAA;AAAA;AAAA,+BAGGC;AAAA;AAAA;AAAA,gCAGCC;AAAA;AAAA;AAAA,OAGzB,EAAE,KAAK,EAAE,CAChB,CCfA,MAAMC,EAAO,CACT,KAAM,SAAS,cAAc,cAAc,EAC3C,MAAO,SAAS,cAAc,QAAQ,EACtC,IAAK,SAAS,cAAc,aAAa,EACzC,QAAS,SAAS,cAAc,UAAU,EAC1C,MAAO,SAAS,cAAc,WAAW,EACzC,SAAU,SAAS,cAAc,YAAY,CACjD,EAEA,IAAIV,EAAO,EACPD,EAEJ,MAAMY,EAAU,CACZ,KAAM,KACN,WAAY,QACZ,UAAW,CACf,EAEA,IAAIC,EAAW,IAAI,qBAAqBC,EAAiBF,CAAO,EAEhED,EAAK,KAAK,iBAAiB,SAAUI,CAAc,EACnD,OAAO,iBAAiB,SAAUC,EAASC,EAAkB,GAAG,CAAC,EAiBjE,eAAeF,EAAeG,EAAK,CAK/B,GAJAA,EAAI,eAAc,EAClBjB,EAAO,GACPD,EAAckB,EAAI,OAAO,YAAY,MAEjClB,IAAgB,GAChB,OAAOR,EAAY,0EAA0E,EAEjGqB,EAAS,QAAQF,EAAK,KAAK,EAE3B,MAAMP,EAAO,MAAML,EAAYC,EAAaC,CAAI,EAC1CkB,EAAOf,EAAK,KAMlB,GALA,QAAQ,IAAI,oBAAqBA,CAAI,EACrC,QAAQ,IAAI,yBAA0Be,CAAI,EAC1C,QAAQ,IAAI,0BAA2BA,EAAK,KAAK,EACjD,QAAQ,IAAI,gCAAiCA,EAAK,KAAK,MAAM,EAEzDA,EAAK,KAAK,SAAW,EACrB,OAAA3B,EAAY,0EAA0E,EAC/EmB,EAAK,KAAK,QAErBhB,EAAewB,EAAK,KAAK,EAEzBR,EAAK,QAAQ,UAAYR,EAAcgB,EAAK,IAAI,EAChDR,EAAK,KAAK,OAEd,CAEA,SAASG,EAAgBM,EAAS,CAC9BA,EAAQ,QAAQ,MAAMC,GAAS,CAE3B,GADA,QAAQ,IAAIA,CAAK,EACbA,EAAM,eAAgB,CACtBpB,GAAQ,EACR,MAAMG,EAAO,MAAML,EAAYC,EAAaC,CAAI,EAIhD,GAFAU,EAAK,QAAQ,mBAAmB,YAAaR,EAAcC,EAAK,KAAK,IAAI,CAAC,EAEtEH,GAAQ,GACR,OAAAY,EAAS,WAAU,EACZ,WAAW,IAAM,CACpBrB,EAAY,4DAA4D,CAC3E,EAAE,GAAI,CAEd,CACT,CAAK,CACL,CAEA,SAASyB,GAAmB,CACpB,OAAO,SAAW,IAClBN,EAAK,SAAS,UAAU,OAAO,kBAAmB,EAAK,EAEvDA,EAAK,SAAS,UAAU,OAAO,kBAAmB,EAAI,CAE9D"}